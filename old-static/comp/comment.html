<script id="commentOfPostTp" type="text/html">
	<div id="comment_l1_of_post_<%:=post.id%>" class="comment-l1 bg-light border border-light" style="display: none">
		<div class="input-group input-group-lg">
			<div class="input-group-prepend">
				<span class="input-group-text" id="comment_l1_span_<%:=post.id%>">评论</span>
			</div>
			<input id="comment_l1_text_<%:=post.id%>" type="text" class="form-control"
				   aria-describedby="comment_l1_span_<%:=post.id%>">
			<button data-id="<%:=post.id%>" onclick="sendComment(this, 'l1')" class="btn-primary"
					style="display: inline; width: 20%">发送
			</button>
		</div>
		<div class="btn-group btn-group-toggle" style="width: 95%;margin-left: 2.5%; margin-top:1em" data-toggle="buttons">
			<label class="btn btn-outline-dark active" data-id="<%:=post.id%>" onclick="switchCommentL1Rank(this, 'popular')">
				<input type="radio" checked/>按热度排序
			</label>
			<label class="btn btn-outline-dark" data-id="<%:=post.id%>" onclick="switchCommentL1Rank(this, 'latest')">
				<input type="radio"/>按时间排序
			</label>
		</div>
		<div id="comment_l1_list_<%:=post.id%>" style="width: 95%; margin-left: 2.5%">
		</div>
		<%if(post.comment_cnt !== 0){%>
		<button id="more_comment_l1_btn_<%:=post.id%>" data-id="<%:=post.id%>"
				style="width: 95%; margin-left: 2.5%" class="btn btn-lg btn-outline-dark"
				onclick="readMoreComments(this, 'l1')">更多
		</button>
		<%}%>
	</div>
</script>

<script id="commentTp" type="text/html">
	<%for(let i = 0; i < list.length; i++) {%>
	<div id="comment_l1_<%:=list[i].id%>" class="card mt-2">
		<div class="card-header" style="position: relative">
			<img src="<%:=getUserAvatarUrl(list[i].creator)%>" style="border-radius: 100%; width: 50px;height: 50px"/>
			<a href="user_info.html?user_id=<%:=list[i].creator.id%>" class="text-dark"><%:=list[i].creator.nick_name%></a>
			<%if(list[i].is_topped){%><span class="badge badge-primary">置顶</span><%}%>
			<span style="position: absolute; right: 1em; bottom: 0.25em"><%:=contentDropTp({content: list[i]})%></span>
		</div>
		<div class="card-body">
			<p id="comment_l1_content_<%:=list[i].id%>" class="card-text"><%:=list[i].content%></p>
		</div>
		<div class="card-footer text-muted text-left" style="position:relative">
			<%:=getFormatDate(list[i].create_time, 'yyyy年MM月dd日 hh:mm')%>
			<div style="position: absolute; right: 10em; bottom: -0.1em">
				<%if(list[i].is_topped && list[i].rights && list[i].rights.be_topped){%>
				<button class="btn btn-link" style="margin-bottom: 0.2em;" data-post-id="<%:=list[i].post_id%>" data-id="<%:=list[i].id%>" onclick="setTop(this, true)">
					取消置顶
				</button>
				<%}else if(list[i].rights && list[i].rights.be_topped){%>
				<button class="btn btn-link" style="margin-bottom: 0.2em;" data-post-id="<%:=list[i].post_id%>" data-id="<%:=list[i].id%>" onclick="setTop(this, false)">
					置顶
				</button>
				<%}%>
				<%if(list[i].l2_cnt !== 0 && list[i].l2_cnt > list[i].preview_l2_list.length){%>
				<button id="more_comment_l2_btn_<%:=list[i].id%>" data-id="<%:=list[i].id%>"
						style="margin-bottom: 0.2em;" class="btn btn-link"
						onclick="readMoreComments(this, 'l2')">更多回复
				</button>
				<%}%>
				<button style="margin-bottom: 0.2em;" class="btn btn-link" onclick="showLikeList('<%:=list[i].id%>', 'cml1')">
					查看点赞列表
				</button>
				<button style="margin-bottom: 0.2em;" id="comment_l2_reply_btn_<%:=list[i].id%>" class="btn btn-link" onclick="toggleElem('comment_l2_input_group_<%:=list[i].id%>')">回复</button>
				<span>(包含发帖人<%:=list[i].poster_rep_cnt%>条)</span>
			</div>
			<div style="position: absolute; right: 1em; font-size: 1.25em">
					<span data-id="<%:=list[i].id%>" data-shown="0"
						  class="footer-icon icon-comment-alt" style="right:4.5em; bottom: 0em"></span>
				<span id="comment_l2_cnt_<%:=list[i].id%>" class="footer-text"
					  style="right:3.5em"><%:=list[i].l2_cnt%></span>
				<%if(list[i].liked_by_viewer){%>
				<span style="right:2em; bottom: -0.075em" data-liked="1" data-id="<%:=list[i].id%>"
					  onclick="createOrCancelLike(this, 'cml1')" class="footer-icon icon-heart">
					</span>
				<%}else{%>
				<span style="right:2em; bottom: -0.075em" data-liked="0" data-id="<%:=list[i].id%>"
					  onclick="createOrCancelLike(this, 'cml1')" class="footer-icon icon-heart-empty">
					</span>
				<%}%>
				<span id="like_cnt_cml1_<%:=list[i].id%>" class="footer-text"
					  style="right:1em"><%:=list[i].like_cnt%></span>
			</div>
		</div>
	</div>
	<div id="comment_l2_of_l1_<%:=list[i].id%>" class="comment-l2 bg-light border border-light">
		<div id="comment_l2_input_group_<%:=list[i].id%>" class="input-group input-group-lg" style="display: none">
			<div class="input-group-prepend">
				<span class="input-group-text" id="comment_l2_span_<%:=list[i].id%>">评论</span>
			</div>
			<input id="comment_l2_text_<%:=list[i].id%>" type="text" class="form-control"
				   aria-describedby="comment_l2_span<%:=list[i].id%>">
			<button data-id="<%:=list[i].id%>" onclick="sendComment(this, 'l2')" class="btn-primary"
					style="display: inline; width: 20%">发送
			</button>
		</div>
		<div id="comment_l2_list_<%:=list[i].id%>" style="width: 95%; margin-left: 5%">
			<%if(typeof list[i].preview_l2_list !== 'undefined'){%>
			<%:=cml2Tp({contentDropTp: contentDropTp, list:list[i].preview_l2_list})%>
			<%}%>
		</div>
	</div>
	<%}%>
</script>

<script id="cml2Tp" type="text/html">
	<%for(let i = 0; i < list.length; ++i) {%>
	<div id="comment_l2_<%:=list[i].id%>" class="card mt-2">
		<div class="card-header" style="position: relative">
			<img src="<%:=getUserAvatarUrl(list[i].creator)%>" style="border-radius: 100%; width: 50px;height: 50px"/>
			<a href="user_info.html?user_id=<%:=list[i].creator.id%>" class="text-dark"><%:=list[i].creator.nick_name%></a>
			<span style="position: absolute; right: 1em; bottom: 0.25em"><%:=contentDropTp({content: list[i]})%></span>
		</div>
		<div class="card-body">
			<p id="comment_l2_content_<%:=list[i].id%>" class="card-text"><%:=list[i].content%></p>
		</div>
		<div class="card-footer text-muted text-left" style="position:relative">
			<%:=getFormatDate(list[i].create_time, 'yyyy年MM月dd日 hh:mm')%>
			<div style="position: absolute; right: 10em; bottom: -0.1em">
				<button style="margin-bottom: 0.2em;" class="btn btn-link" onclick="showLikeList('<%:=list[i].id%>', 'cml2')">
					查看点赞列表
				</button>
			</div>
			<div style="position: absolute; right: 1em; font-size: 1.25em">
				<%if(list[i].liked_by_viewer){%>
				<span style="right:2em; bottom: -0.075em" data-liked="1" data-id="<%:=list[i].id%>"
					  onclick="createOrCancelLike(this, 'cml2')" class="footer-icon icon-heart">
                </span>
				<%}else{%>
				<span style="right:2em; bottom: -0.075em" data-liked="0" data-id="<%:=list[i].id%>"
					  onclick="createOrCancelLike(this, 'cml2')" class="footer-icon icon-heart-empty">
                </span>
				<%}%>
				<span id="like_cnt_cml2_<%:=list[i].id%>" class="footer-text"
					  style="right:1em"><%:=list[i].like_cnt%></span>
			</div>
		</div>
	</div>
	<%}%>
</script>
